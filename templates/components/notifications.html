<!-- notifications.html -->
<div class="dropdown">
  <a class="btn btn-primary position-relative dropdown-toggle" href="#" role="button" id="notificationDropdown" data-bs-toggle="dropdown" aria-expanded="false">
    <i class="fas fa-bell"></i>
    {% if request.unread_notifications %}
      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {% if request.unread_notifications|length >= 100 %}
          99+
        {% else %}
          {{ request.unread_notifications|length }}
        {% endif %}
        <span class="visually-hidden">unread messages</span>
      </span>
    {% endif %}
  </a>

  <!-- Dropdown Menu -->
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown" style="background-color: #f7f7f7;">
    {% if request.unread_notifications %}
      {% for notification in request.unread_notifications %}
        <li class="d-flex align-items-start p-3 {% if not forloop.last %}border-bottom{% endif %}" >
          <a class="dropdown-item d-flex align-items-center" href="{{ notification.link }}" style="width: 100%;">
            <!-- You can set a specific icon based on the type of the notification -->
            <div class="me-3">
                {% if notification.type == 'info' %}
                  <i class="fas fa-info-circle"></i>
                {% elif notification.type == 'warning' %}
                  <i class="fas fa-exclamation-triangle"></i>
                {% elif notification.type == 'danger' %}
                  <i class="fas fa-exclamation-circle"></i>
                {% endif %}
              </div>
            <div style="flex-grow: 1;">
              <div class="fw-bold" style="margin-bottom: 5px;">{{ notification.title }}</div>
              <div class="text-truncate" style="max-width: 200px; margin-bottom: 5px;">{{ notification.message|truncatechars:50 }}</div>
              <small class="text-muted">{{ notification.timestamp|date:"SHORT_DATETIME_FORMAT" }}</small>
            </div>
          </a>
        </li>


      {% endfor %}
    {% else %}
      <li><a class="dropdown-item" href="#">No notifications at this time</a></li>
    {% endif %}
  </ul>
</div>
